<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="[GraphQL] GraphQLResolver"><meta name="keywords" content="GraphQL,Spring Boot"><meta name="author" content="Song Hayoung"><meta name="copyright" content="Song Hayoung"><title>[GraphQL] GraphQLResolver | SUMFIのBlog</title><link rel="shortcut icon" href="/songcon.ico"><link rel="stylesheet" href="/css/index.css?version=1.7.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.7.0"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css?version=1.7.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.js" defer></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><link rel="dns-prefetch" href="https://www.google-analytics.com"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-169368422-1', 'auto');
ga('send', 'pageview');</script><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"7LZ6OJ4D6C","apiKey":"9a84e13f74ea78c3fd54512c10139c56","indexName":"git blog","hits":{"per_page":10},"languages":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}.","hits_stats":"${hits} results found in ${time} ms"}},
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/rss2.xml" title="SUMFIのBlog" type="application/rss+xml">
</head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#GraphQLResolver"><span class="toc-number">1.</span> <span class="toc-text">GraphQLResolver</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Repository"><span class="toc-number">2.</span> <span class="toc-text">Repository</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://avatars3.githubusercontent.com/u/37806785?s=460&amp;u=8c68d685faf7c5280cfbd736a6b1730b55fb4203&amp;v=4"></div><div class="author-info__name text-center">Song Hayoung</div><div class="author-info__description text-center"></div><div class="follow-button"><a target="_blank" rel="noopener" href="https://www.instagram.com/hayoung0_0/">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">8071</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">193</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">59</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">VISITED</div><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">Seoul Korea</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">Jeju Korea</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">British Columbia Canada</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">Boracay Philippines</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">三重　日本</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">大阪　日本</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">名古屋　日本</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">静岡　日本</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">札幌　日本</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">京都　日本</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">Bangkok Thailand</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://xxxx.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">SUMFIのBlog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a><a class="site-page" href="/about">About</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> Search</span></a></span></div><div id="post-info"><div id="post-title">[GraphQL] GraphQLResolver</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-07-25</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/GraphQL/">GraphQL</a><div class="post-meta-wordcount"><span>Word count: </span><span class="word-count">994</span><span class="post-meta__separator">|</span><span>Reading time: 6 min</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><blockquote>
<p>본 포스트는 공식 레퍼런스를 참고해 GraphQL을 공부하며 직접 작성한 가이드 입니다.<br>본 포스트는 2021년 7월 최신 버전인 v16.2를 기준으로 작성되어 있습니다.</p>
</blockquote>
<h2 id="GraphQLResolver"><a href="#GraphQLResolver" class="headerlink" title="GraphQLResolver"></a>GraphQLResolver</h2><span id="more"></span>
<p>앞서 GraphQLResolver를 통해 쿼리를 매핑시키는것을 확인했다. 이제는 GraphQLResolver를 통해 <strong>더 유연하게 API를</strong> 구성해볼 차례이다. 앞서 이야기한 <code>WebToon의 스키마 구조와 쿼리</code>이다. (내 회사랑은 상관 없다..)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">type WebToon &#123;</span><br><span class="line">    id: ID!</span><br><span class="line">    webToonType: WebToonType</span><br><span class="line">    title: String</span><br><span class="line">    image: Image</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type Image &#123;</span><br><span class="line">    thumbnail: String!</span><br><span class="line">    imageList: [String]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">query GET_WEBTOON($id: ID!) &#123;</span><br><span class="line">    webToon(id: $id) &#123;</span><br><span class="line">        id</span><br><span class="line">        title</span><br><span class="line">        webToonType</span><br><span class="line">        image &#123;</span><br><span class="line">            thumbnail</span><br><span class="line">            imageList</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>GET_WEBTOON</code> 쿼리를 실행했을 때 <code>id</code> <code>title</code> <code>webToonType</code>만 가져오고 싶을 때가 있고 <code>image</code>를 추가해서 가져오고 싶을때도 있을것이다. <code>image</code>가 필요없는 요청에 대한 케이스에서 저장소에 접근해서 해당 웹툰의 이미지 정보까지 가져오는거는 자원의 낭비라고 볼 수 있다. 게다가 만약 <code>WebToon</code>의 메타데이터는 캐시에 저장해두고 <code>image</code> 데이터는 <code>RDB</code>나 물리적으로 다른 캐시에 저장하고 있다면 어떨까? 실질적으로 <code>WebToon</code>과 <code>Image</code>는 <code>1 : N</code>관계이니 나눠서 저장할 수 밖에 없을 것이다. 그렇다면 물리적으로 나뉘는 두 저장소에서 요청에 포함될지 안될지도 모르는 <code>image</code>를 가져오기 위해 필요 없는 접근을 추가해야하니 리소스 낭비라고 볼 수 있다. 기존의 REST에서는 이런 문제가 있어도 개발 생산성이나 다양한 문제 때문에 모든 정보를 내려주고 클라이언트 쪽에서 처리하도록 되어있었다. 혹은 API를 작은 단위로 분리해서 여러번 요청을 통해 정보를 가져오기도 한다. 어느쪽이든 리소스가 낭비되거나 여러번 요청을 통한 서버사이드에 부하가 유발될 수 있다. 이제 이 문제를 <code>GraphQL</code>로 해결하기 위해 우리가 기존에 짜두었던 <code>WebToonResolver</code>를 리팩토링하자.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebToonResolver</span> <span class="keyword">implements</span> <span class="title class_">GraphQLQueryResolver</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> WebToon <span class="title function_">webToon</span><span class="params">(UUID id, DataFetchingEnvironment env)</span> &#123;</span><br><span class="line">        <span class="type">GraphQLServletContext</span> <span class="variable">context</span> <span class="operator">=</span> env.getContext();</span><br><span class="line">        <span class="type">String</span> <span class="variable">authHeader</span> <span class="operator">=</span> context.getHttpServletRequest().getHeader(<span class="string">&quot;Auth&quot;</span>);</span><br><span class="line"></span><br><span class="line">        log.info(<span class="string">&quot;getWebtoon request accepted id: &#123;&#125;&quot;</span>, id);</span><br><span class="line">        log.info(<span class="string">&quot;getWebtoon request accepted header: &#123;&#125;&quot;</span>, authHeader);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> WebToon.builder().id(id).title(<span class="string">&quot;여신강림&quot;</span>).webToonType(WebToonType.Origianls).build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>이제 <code>WebToonResolver</code>에서는 <code>image</code>에 대한 정보를 넣어주지 않는다. 그렇다면 <code>image</code>가 필요한 요청에 대해서는 어떻게 해야할까? 답은 웹툰에 대한 <code>GraphQLResolver</code>를 만들어주면 된다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ImageResolver</span> <span class="keyword">implements</span> <span class="title class_">GraphQLResolver</span>&lt;WebToon&gt; &#123;</span><br><span class="line">    <span class="keyword">public</span> Image <span class="title function_">image</span><span class="params">(WebToon webToon)</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;requesting image data for webtoon id: &#123;&#125;&quot;</span>, webToon.getId());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Image.builder().thumbnail(<span class="string">&quot;thumbnail URL&quot;</span>).imageList(Arrays.asList(<span class="string">&quot;episode imgae1 URL&quot;</span>)).build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>이렇게 구조를 계층적으로 잡아두면 <code>WebToon</code>에 대한 요청에서 <code>image</code>가 필요한 경우만 <code>ImageResolver</code>에 매핑되서 결과를 알아서 <code>WebToon</code>에 바인딩해준다.</p>
<p>이렇듯 <code>image</code>에 대한 요청이 있는 쿼리에서는 <code>image</code>에 대한 정보도 가져오고 로그에도 잘 찍힌다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">query GET_WEBTOON($id: ID!) &#123;</span><br><span class="line">    webToon(id: $id) &#123; # WebToonResolver</span><br><span class="line">        id</span><br><span class="line">        title</span><br><span class="line">        webToonType</span><br><span class="line">        image &#123; # ImageResolver</span><br><span class="line">            thumbnail</span><br><span class="line">            imageList</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;webToon&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;3568e088-ec83-11eb-9a03-0242ac130003&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;여신강림&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;webToonType&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Origianls&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;image&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;thumbnail&quot;</span><span class="punctuation">:</span> <span class="string">&quot;thumbnail URL&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;imageList&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="string">&quot;episode imgae1 URL&quot;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2021-07-25 01:22:08.087  INFO 13062 --- [nio-8080-exec-2] c.s.g.r.webtoon.query.WebToonResolver    : getWebtoon request accepted id: 3568e088-ec83-11eb-9a03-0242ac130003</span><br><span class="line">2021-07-25 01:22:08.088  INFO 13062 --- [nio-8080-exec-2] c.s.g.r.webtoon.query.WebToonResolver    : getWebtoon request accepted header: Bearer TOKEN</span><br><span class="line">2021-07-25 01:22:08.098  INFO 13062 --- [nio-8080-exec-2] c.s.g.resolver.webtoon.ImageResolver     : requesting image data for webtoon id: 3568e088-ec83-11eb-9a03-0242ac130003</span><br></pre></td></tr></table></figure>
<p>물론 <code>image</code>에 대한 요청이 없는 쿼리에 대해서는 <code>ImageResolver</code>를 거치지 않고 바로 응답을 주는걸 확인할 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 웹툰 가져오기</span><br><span class="line">query GET_WEBTOON($id: ID!) &#123;</span><br><span class="line">    webToon(id: $id) &#123; # WebToonResolver</span><br><span class="line">        id</span><br><span class="line">        title</span><br><span class="line">        webToonType</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;webToon&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;3568e088-ec83-11eb-9a03-0242ac130003&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;여신강림&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;webToonType&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Origianls&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2021-07-25 01:23:23.093  INFO 13062 --- [nio-8080-exec-6] c.s.g.r.webtoon.query.WebToonResolver    : getWebtoon request accepted id: 3568e088-ec83-11eb-9a03-0242ac130003</span><br><span class="line">2021-07-25 01:23:23.094  INFO 13062 --- [nio-8080-exec-6] c.s.g.r.webtoon.query.WebToonResolver    : getWebtoon request accepted header: Bearer TOKEN</span><br></pre></td></tr></table></figure>
<p>이렇듯 요청에 따라 <code>Resolver</code>를 분리해서 효율적으로 리소스를 사용해서 응답을 내려줄 수 있다. 그런데 물리적으로 분리된 다른 저장소가 아니라 하나의 저장소에서 <code>JOIN</code>과 같은 쿼리를 사용해 데이터를 가져올 수 있는 상황이라면 어떨까? 게다가 <code>JOIN</code>을 사용하는게 더 효율적이라면 어떨까? 그렇게 된다면 이렇게 쿼리를 나눠두는것 보다 <code>image</code>가 있는 요청에서는 <code>JOIN</code>을 사용해서 데이터를 가져오는 방식으로 유연하게 설계를 구성할 수 있을것이다. 다시 우리가 짜둔 코드를 리팩토링 하자.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebToonResolver</span> <span class="keyword">implements</span> <span class="title class_">GraphQLQueryResolver</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ImageBO imageBO;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> WebToonBO webToonBO;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> DataFetcherResult&lt;WebToon&gt; <span class="title function_">webToon</span><span class="params">(UUID id, DataFetchingEnvironment env)</span> &#123;</span><br><span class="line">        <span class="type">GraphQLServletContext</span> <span class="variable">context</span> <span class="operator">=</span> env.getContext();</span><br><span class="line">        <span class="type">String</span> <span class="variable">authHeader</span> <span class="operator">=</span> context.getHttpServletRequest().getHeader(<span class="string">&quot;Auth&quot;</span>);</span><br><span class="line"></span><br><span class="line">        log.info(<span class="string">&quot;getWebtoon request accepted id: &#123;&#125;&quot;</span>, id);</span><br><span class="line">        log.info(<span class="string">&quot;getWebtoon request accepted header: &#123;&#125;&quot;</span>, authHeader);</span><br><span class="line"></span><br><span class="line">        <span class="type">WebToon</span> <span class="variable">webToon</span> <span class="operator">=</span> webToonBO.getWebToon(id);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(env.getSelectionSet().contains(<span class="string">&quot;image&quot;</span>)) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;request need image for webtoon&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="type">Image</span> <span class="variable">image</span> <span class="operator">=</span> imageBO.getImage(id);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> DataFetcherResult.&lt;WebToon&gt;newResult()</span><br><span class="line">                    .data(webToon)</span><br><span class="line">                    .localContext(image)</span><br><span class="line">                    .build();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> DataFetcherResult.&lt;WebToon&gt;newResult()</span><br><span class="line">                .data(webToon)</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>위 코드에서는 <code>image</code>에 대한 요청이 있을 때 <code>image</code>를 저장소에서 가져와서 <code>localContext</code>에 저장해두고 있다. 이제 <code>ImageResolver</code>는 저장된 <code>image</code>를 <code>localContext</code>에 가져와서 반환해주면 된다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ImageResolver</span> <span class="keyword">implements</span> <span class="title class_">GraphQLResolver</span>&lt;WebToon&gt; &#123;</span><br><span class="line">    <span class="keyword">public</span> DataFetcherResult&lt;Image&gt; <span class="title function_">image</span><span class="params">(WebToon webToon, DataFetchingEnvironment env)</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;requesting image data for webtoon id: &#123;&#125;&quot;</span>, webToon.getId());</span><br><span class="line"></span><br><span class="line">        <span class="type">Image</span> <span class="variable">image</span> <span class="operator">=</span> env.getLocalContext();</span><br><span class="line"></span><br><span class="line">        log.info(<span class="string">&quot;get image data from local context. thumbnail : &#123;&#125;&quot;</span>,image.getThumbnail());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> DataFetcherResult.&lt;Image&gt;newResult()</span><br><span class="line">                .data(image)</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>이렇듯 스토리지의 상황과 api에 따라서 유연하게 코드를 작성해 효율적으로 응답을 내려줄 수 있게 된다.</p>
<h2 id="Repository"><a href="#Repository" class="headerlink" title="Repository"></a>Repository</h2><blockquote>
<p>모든 가이드의 예제 코드는 <a target="_blank" rel="noopener" href="https://github.com/SongHayoung/springboot-graphql-tutorial">SongHayoung/springboot-graphql-tutorial</a>에서 확인할 수 있습니다.</p>
</blockquote>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Song Hayoung</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://songhayoung.github.io/2021/07/25/GraphQL/graphql-5/">https://songhayoung.github.io/2021/07/25/GraphQL/graphql-5/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/GraphQL/">GraphQL</a><a class="post-meta__tags" href="/tags/Spring-Boot/">Spring Boot</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2021/07/25/GraphQL/graphql-6/"><i class="fa fa-chevron-left">  </i><span>[GraphQL] Exception Handling</span></a></div><div class="next-post pull-right"><a href="/2021/07/24/GraphQL/graphql-4/"><span>[GraphQL] Spring Boot에서 더 잘 사용하기</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="gitalk-container"></div><script>var gitalk = new Gitalk({
  clientID: '3604b61642355579f55e',
  clientSecret: 'f552120f18ac5aee3f6297e05e97d94c0a25cd4b',
  repo: 'SongHayoung.github.io',
  owner: 'SongHayoung',
  admin: 'SongHayoung',
  id: md5(decodeURI(location.pathname)),
  language: 'en'
})
gitalk.render('gitalk-container')</script></div></div><footer class="footer-bg" style="background-image: url(https://xxxx.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2020 - 2023 By Song Hayoung</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">Learning how to walk slowly to not miss important things</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.7.0"></script><script src="/js/fancybox.js?version=1.7.0"></script><script src="/js/sidebar.js?version=1.7.0"></script><script src="/js/copy.js?version=1.7.0"></script><script src="/js/fireworks.js?version=1.7.0"></script><script src="/js/transition.js?version=1.7.0"></script><script src="/js/scroll.js?version=1.7.0"></script><script src="/js/head.js?version=1.7.0"></script><script src="/js/search/algolia.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="algolia-search"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>