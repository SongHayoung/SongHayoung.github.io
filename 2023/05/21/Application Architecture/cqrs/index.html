<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="[Application Architecture] CQRS"><meta name="keywords" content="Application Architecture"><meta name="author" content="Song Hayoung"><meta name="copyright" content="Song Hayoung"><title>[Application Architecture] CQRS | SUMFIのBlog</title><meta name="robots" content="noindex"><link rel="shortcut icon" href="/songcon.ico"><link rel="stylesheet" href="/css/index.css?version=1.7.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.7.0"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css?version=1.7.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.js" defer></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><link rel="dns-prefetch" href="https://www.google-analytics.com"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-169368422-1', 'auto');
ga('send', 'pageview');</script><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"7LZ6OJ4D6C","apiKey":"9a84e13f74ea78c3fd54512c10139c56","indexName":"git blog","hits":{"per_page":10},"languages":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}.","hits_stats":"${hits} results found in ${time} ms"}},
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/rss2.xml" title="SUMFIのBlog" type="application/rss+xml">
</head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#CQRS"><span class="toc-number">1.</span> <span class="toc-text">CQRS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#When-to-use"><span class="toc-number">2.</span> <span class="toc-text">When to use</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://avatars3.githubusercontent.com/u/37806785?s=460&amp;u=8c68d685faf7c5280cfbd736a6b1730b55fb4203&amp;v=4"></div><div class="author-info__name text-center">Song Hayoung</div><div class="author-info__description text-center"></div><div class="follow-button"><a target="_blank" rel="noopener" href="https://www.linkedin.com/in/hayoung-song-9523b61bb/">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">11512</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">199</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">62</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">VISITED</div><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">Seoul Korea</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">Jeju Korea</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">British Columbia Canada</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">Boracay Philippines</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">三重　日本</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">大阪　日本</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">名古屋　日本</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">静岡　日本</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">札幌　日本</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">京都　日本</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">Bangkok Thailand</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://xxxx.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">SUMFIのBlog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a><a class="site-page" href="/about">About</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> Search</span></a></span></div><div id="post-info"><div id="post-title">[Application Architecture] CQRS</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2023-05-21</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Application-Architecture/">Application Architecture</a><div class="post-meta-wordcount"><span>Word count: </span><span class="word-count">631</span><span class="post-meta__separator">|</span><span>Reading time: 3 min</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h2 id="CQRS"><a href="#CQRS" class="headerlink" title="CQRS"></a>CQRS</h2><span id="more"></span>
<p>CQRS는 명령 쿼리 책임 분리(Command Query Responsibility Segregation)의 약자다. 이 패턴의 핵심은 정보를 읽을 때 사용하는 모델과 다른 모델을 사용해 정보를 업데이트할 수 있다는 개념이다. 일부 상황에서는 이러한 분리가 유용할 수 있지만, 대부분의 시스템에서 CQRS는 위험한 복잡성을 추가한다는 점에 유의해야 한다.</p>
<p>사람들이 정보 시스템과 상호 작용할 때 주로 사용하는 접근 방식은 CRUD 데이터 저장소로 취급하는 방식이다. 새 레코드를 만들고, 읽고, 업데이트하고, 삭제할 수 있는 레코드 구조에 대한 정신적 모델을 가지고 있다는 의미다. </p>
<p>하지만 요구사항이 더 정교해짐에 따라 그 정신적 모델에서 점차 멀어지고 있다. 여러 레코드를 하나로 통합하거나 여러 장소에 대한 정보를 결합하여 가상 레코드를 생성하는 등 레코드 저장소와 다른 방식으로 정보를 살펴보고 싶을 수도 있다. 업데이트 측면에서는 특정 데이터 조합만 저장할 수 있도록 허용하는 유효성 검사 규칙을 찾거나, 우리가 제공하는 데이터와 다른 데이터를 저장하도록 추론할 수 있다.</p>
<p><img src="https://cdn.jsdelivr.net/gh/SongHayoung/image@master/uPic/image-20230522002450822.png" alt=""></p>
<p>이렇게 되면 정보의 여러 표현이 보이기 시작한다. 사용자는 정보와 상호 작용할 때 이 정보의 다양한 프레젠테이션을 사용하며, 각 프레젠테이션은 서로 다른 표현을 사용한다. 개발자는 일반적으로 모델의 핵심 요소를 조작하는 데 사용하는 자체 개념 모델을 구축한다. 도메인 모델을 사용하는 경우 일반적으로 도메인에 대한 개념적 표현이다. 또한 일반적으로 영구 저장소를 가능한 한 개념 모델에 가깝게 만든다.</p>
<p>이렇게 여러 계층으로 구성된 표현 구조는 상당히 복잡해질 수 있지만 사람들은 이를 모든 프레젠테이션 간의 개념적 통합 지점 역할을 하는 단일 개념적 표현으로 해결한다.</p>
<p>CQRS가 도입한 변화는 이러한 개념 모델을 업데이트 및 표시를 위해 별도의 모델로 분할하는 것으로, Command Query Separation의 어휘에 따라 각각 Command 및 Query라고 부른다. 그 이유는 대부분의 복잡한 도메인을 다루는 상황에서 명령과 쿼리에 대해 동일한 개념 모델을 사용하면 어느 쪽도 잘 수행하지 못하는 더 복잡한 모델로 이어지기 때문이다.</p>
<p><img src="https://cdn.jsdelivr.net/gh/SongHayoung/image@master/uPic/image-20230522002823139.png" alt=""></p>
<p>별도의 모델이란 일반적으로 서로 다른 논리적 프로세스에서 실행되거나 별도의 하드웨어에서 실행되는 서로 다른 객체 모델을 의미한다. 이 부분에는 상당한 변형의 여지가 있다. 인메모리 모델은 동일한 데이터베이스를 공유할 수 있으며, 이 경우 데이터베이스가 명령과 쿼리 모델간의 통신 역할을 한다. 두 모델은 별도의 객체 모델이 아닐 수도 있고, 관계형 데이터베이스의 뷰처럼 동일한 객체가 명령 측과 쿼리 측에 서로 다른 인터페이스를 가지고 있을 수도 있다. 하지만 일반적으로 CQRS에 대해 들으면 분명히 별개의 모델이다.</p>
<p>CQRS는 다른 아키텍처 패턴과도 자연스럽게 어울린다.</p>
<ul>
<li>CRUD를 통해 상호 작용하는 단일 표현에서 벗어나면 task-based UI로 쉽게 이동할 수 있다.</li>
<li>CQRS는 이벤트 기반 프로그래밍 모델과도 잘 맞다. CQRS 시스템은 이벤트 협업과 통신하는 별도의 서비스로 분할되는 것이 일반적이다. 이를 통해 이러한 서비스는 이벤트 소싱을 쉽게 활용할 수 있다.</li>
<li>별도의 모델을 사용하면 모델의 일관성을 유지하는 것이 얼마나 어려운지에 대한 의견이 제기되며, 이는 결국 최종적 일관성 모델을 사용할 가능성을 높인다.</li>
<li>많은 도메인의 경우 업데이트할 때 많은 로직이 필요하므로 쿼리측 모델 간소화를 위해 Eager Read Derivation을 사용하는 것이 합리적일 수 있다.</li>
<li>쓰기 모델이 모든 업데이트에 대한 이벤트를 생성하는 경우 읽기 모델을 이벤트 포스터로 구조화한 뒤 메모리 이미지를 사용해 데이터베이스와의 많은 상호 작용을 회피할 수 있다.</li>
<li>CQRS는 도메인 중심 설계의 이점을 누릴 수 있는 복잡한 도메인에 적합하다.</li>
</ul>
<h2 id="When-to-use"><a href="#When-to-use" class="headerlink" title="When to use"></a>When to use</h2><p>다른 패턴과 마찬가지로 CQRS는 어떤 곳에서는 유용하나, 다른곳에서는 유용하지 않다. 많은 시스템이 CRUD 기반 모델에 적합하므로 해당 스타일로 수행된다. CQRS는 모든 이해관계자 간의 많은 도약이 필요하므로 그만한 가치가 없다면 시도해서는 안된다. 특히 CQRS는 시스템 전체가 아닌 시스템의 특정 부분(Bounded context)에만 사용되어야 한다.</p>
<p>CQRS에는 두 가지 장점이 있다. 첫 번째는 몇 가지 복잡한 도메인은 CQRS를 사용하면 더 쉽게 해결할 수 있다는 것이다. 하지만 CQRS에 적합한 케이스는 매우 소수에 불과하다. 일반적으로 명령과 쿼리 측면이 충분히 겹치는 경우 모델을 공유하는 것이 더 쉽다. 일치하지 않는 도메인에서 CQRS를 사용하면 복잡성이 증가해 생산성이 저하되고 위험이 증가한다.</p>
<p>또 다른 주요 이점은 고성능 애플리케이션을 처리할 때다. CQRS를 사용하면 읽기 및 쓰기 부하를 분리할 수 있어, 각각 독립적 확장이 가능하게 된다. 이는 읽기와 쓰기 간에 큰 격차가 발생하는 경우 매우 유용하다. 혹은 읽기와 업데이트에 서로 다른 데이터베이스 엑세스 기술을 사용할 수도 있다.</p>
<p>이런 장점에도 불구하고 CQRS를 선택하는 것은 매우 신중해야 하며, 읽기와 동일한 방식으로 업데이트 되는 데이터 기반 개념과 대비되어 많은 복잡성이 추가될 수 있다.</p>
<!-- flag of hidden posts --></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Song Hayoung</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://songhayoung.github.io/2023/05/21/Application%20Architecture/cqrs/">https://songhayoung.github.io/2023/05/21/Application%20Architecture/cqrs/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Application-Architecture/">Application Architecture</a></div><nav id="pagination"></nav><div id="gitalk-container"></div><script>var gitalk = new Gitalk({
  clientID: '3604b61642355579f55e',
  clientSecret: 'f552120f18ac5aee3f6297e05e97d94c0a25cd4b',
  repo: 'SongHayoung.github.io',
  owner: 'SongHayoung',
  admin: 'SongHayoung',
  id: md5(decodeURI(location.pathname)),
  language: 'en'
})
gitalk.render('gitalk-container')</script></div></div><footer class="footer-bg" style="background-image: url(https://xxxx.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2020 - 2025 By Song Hayoung</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">Learning how to walk slowly to not miss important things</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.7.0"></script><script src="/js/fancybox.js?version=1.7.0"></script><script src="/js/sidebar.js?version=1.7.0"></script><script src="/js/copy.js?version=1.7.0"></script><script src="/js/fireworks.js?version=1.7.0"></script><script src="/js/transition.js?version=1.7.0"></script><script src="/js/scroll.js?version=1.7.0"></script><script src="/js/head.js?version=1.7.0"></script><script src="/js/search/algolia.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="algolia-search"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>