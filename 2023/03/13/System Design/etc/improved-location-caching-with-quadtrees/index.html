<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="[System Design] Improved Location Caching with Quadtrees"><meta name="keywords" content="System Design"><meta name="author" content="Song Hayoung"><meta name="copyright" content="Song Hayoung"><title>[System Design] Improved Location Caching with Quadtrees | SUMFIのBlog</title><link rel="shortcut icon" href="/songcon.ico"><link rel="stylesheet" href="/css/index.css?version=1.7.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.7.0"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css?version=1.7.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.js" defer></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><link rel="dns-prefetch" href="https://www.google-analytics.com"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-169368422-1', 'auto');
ga('send', 'pageview');</script><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"7LZ6OJ4D6C","apiKey":"9a84e13f74ea78c3fd54512c10139c56","indexName":"git blog","hits":{"per_page":10},"languages":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}.","hits_stats":"${hits} results found in ${time} ms"}},
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/rss2.xml" title="SUMFIのBlog" type="application/rss+xml">
</head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Improved-Location-Caching-with-Quadtrees"><span class="toc-number">1.</span> <span class="toc-text">Improved Location Caching with Quadtrees</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Background"><span class="toc-number">2.</span> <span class="toc-text">Background</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Basic-caching"><span class="toc-number">3.</span> <span class="toc-text">Basic caching</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Tiles-and-grids"><span class="toc-number">4.</span> <span class="toc-text">Tiles and grids</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Grid-accuracy"><span class="toc-number">5.</span> <span class="toc-text">Grid accuracy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Dynamic-Grids"><span class="toc-number">6.</span> <span class="toc-text">Dynamic Grids</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Quadtrees-in-action"><span class="toc-number">7.</span> <span class="toc-text">Quadtrees in action</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Results"><span class="toc-number">8.</span> <span class="toc-text">Results</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://avatars3.githubusercontent.com/u/37806785?s=460&amp;u=8c68d685faf7c5280cfbd736a6b1730b55fb4203&amp;v=4"></div><div class="author-info__name text-center">Song Hayoung</div><div class="author-info__description text-center"></div><div class="follow-button"><a target="_blank" rel="noopener" href="https://www.instagram.com/hayoung0_0/">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">7813</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">192</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">59</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">VISITED</div><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">Seoul Korea</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">Jeju Korea</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">British Columbia Canada</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">Boracay Philippines</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">三重　日本</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">大阪　日本</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">名古屋　日本</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">静岡　日本</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">札幌　日本</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">京都　日本</a><a class="author-info-links__name text-center" href="https://songhayoung.github.io/">Bangkok Thailand</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://xxxx.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">SUMFIのBlog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a><a class="site-page" href="/about">About</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> Search</span></a></span></div><div id="post-info"><div id="post-title">[System Design] Improved Location Caching with Quadtrees</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2023-03-13</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/System-Design/">System Design</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/System-Design/Etc/">Etc</a><div class="post-meta-wordcount"><span>Word count: </span><span class="word-count">885</span><span class="post-meta__separator">|</span><span>Reading time: 5 min</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h2 id="Improved-Location-Caching-with-Quadtrees"><a href="#Improved-Location-Caching-with-Quadtrees" class="headerlink" title="Improved Location Caching with Quadtrees"></a>Improved Location Caching with Quadtrees</h2><span id="more"></span>
<p>초당 수천 건의 요청을 처리하는 웹 서비스를 구축하려면 좋은 캐싱 전략이 필요하다. 하지만 지리적 위치가 이러한 요청의 주요 매개변수인 경우, 기존 캐싱 전략은 제대로 동작하지 않는다. 이번 포스트는 지리적 위치를 캐싱하는 다양한 접근 방식과 상대적 장단점을 살펴본다.</p>
<h2 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h2><p>Xone이라는 애플리케이션은 사용자의 지리적 위치를 기반으로 주변의 비즈니스 목록을 제공한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /nearbyBusinesses?latitude=40.741111&amp;longitude=-73.987448</span><br></pre></td></tr></table></figure>
<p>이 엔드포인트는 지정된 위치 근처의 최대 20개의 비즈니스를 반환한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;businesses&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;id&quot;: &quot;someid&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Some Business&quot;,</span><br><span class="line">      &quot;location&quot;: &#123; &quot;latitude&quot;: 40.7423, &quot;longitude&quot;: -73.98653 &#125;,</span><br><span class="line">      ...</span><br><span class="line">    &#125;,</span><br><span class="line">    ...</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Xone 백엔드는 피크 시간에 초당 4000건 이상의 요청을 받으므로 모든 요청에 대한 결과를 계산하려면 데이터 베이스에 부하가 빠르게 걸리게 된다. 다행히 많은 검색이 비슷한 위치에서 발생하고 동일한 응답을 받는다. 최근에 계산한 응답을 캐시해두었다가 비슷한 요청이 들어올 때 재사용함으로 처리 능력과 시간을 많이 절약할 수 있다.</p>
<h2 id="Basic-caching"><a href="#Basic-caching" class="headerlink" title="Basic caching"></a>Basic caching</h2><p>대부분의 웹 서버는 캐싱을 사용해 이전에 계산한 결과를 임시로 저장하여 반복 작업을 수행하지 않도록 한다. 다음은 블로그 서버가 각각의 포스트를 캐싱하는 한 예이다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public static void getPost(int postId) &#123;</span><br><span class="line">    // Try to look up the post in the cache.</span><br><span class="line">    Post post = Cache.get(&quot;post_&quot; + postId, Post.class);</span><br><span class="line"></span><br><span class="line">    // If this particular post wasn&#x27;t cached, look it up in the DB and</span><br><span class="line">    // save it to the cache.</span><br><span class="line">    if (post == null) &#123;</span><br><span class="line">        post = lookupPostFromDb(postId);</span><br><span class="line">        Cache.set(&quot;post_&quot; + postId, post, &quot;30mn&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render(post);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>이런 전략을 Xone 백엔드에 적용하려 한다면 캐시 조회는 아래와 같다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Result&gt; results = </span><br><span class="line">    Cache.get(String.format(&quot;businesses-%f-%f&quot;, latitude, longitude));</span><br></pre></td></tr></table></figure>
<p>이 방식의 문제는 위도와 경도가 너무 세분화되어 있어 캐시 히트율이 떨어진다는 점이다.</p>
<h2 id="Tiles-and-grids"><a href="#Tiles-and-grids" class="headerlink" title="Tiles and grids"></a>Tiles and grids</h2><p>위치 좌표를 처리하는 것은 데이터 소스가 본질적으로 부정확할 수 있기 때문에 어렵다. 위치 판독값의 변동성이 크기 때문에 사용자는 움직이지 않아도 요청마다 다른 추정치를 얻을 수 있다. 그러나 정확한 위치를 보고하더라도 위치 좌표를 캐싱하는 것은 문제가 있다. 사용자는 <code>(40.74120, -73.98679)</code> 에서 <code>(40.74124, -73.98676)</code>로 좌표가 변할 수 있지만 애플리케이션에서는 의미 있는 차이가 아니다.</p>
<p>이 문제를 해결하는 가장 쉬운 전략은 위도 및 경도 값의 정밀도를 낮추는 것이다. 아래는 좌표를 소수점 이하 3자리로 잘라 만든 그리드의 시각화이다.</p>
<p><img src="/image/system-design/2023-03-14-01.png" alt=""></p>
<p>격자 셀은 약 100m * 100m로 모든 좌표를 나타낸다. 정밀도가 낮은 위치 좌표를 사용하면 일반적으로 작은 위치 변경에도 동일한 캐시 키에 매핑된다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String cacheKey = String.format(&quot;businesses-%.03f-%.03f&quot;, lat, lng);</span><br></pre></td></tr></table></figure>
<h2 id="Grid-accuracy"><a href="#Grid-accuracy" class="headerlink" title="Grid accuracy"></a>Grid accuracy</h2><p>소수점 이하 3자리를 잘라낸 뒤 캐시 적중률은 5% 에서 18%로 개선되었다. 다양한 정밀도 수준을 측정한 결과 아래와 같은 결과를 얻을 수 있다.</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>DECIMAL PLACES</th>
<th>CELL SIZE</th>
<th>CACHE HIT RATIO</th>
</tr>
</thead>
<tbody>
<tr>
<td>3 (e.g., 40.741, -73.986)</td>
<td>100m</td>
<td>18%</td>
</tr>
<tr>
<td>2 (e.g., 40.74, -73.98)</td>
<td>1km</td>
<td>65%</td>
</tr>
<tr>
<td>1 (e.g., 40.7, -73.9)</td>
<td>10km</td>
<td>95%</td>
</tr>
</tbody>
</table>
</div>
<p>정밀도를 낮추면서 캐시 히트율은 높아졌지만, 멀리 떨어진 두 사용자가 근처에 20개의 동일한 비즈니스 목록을 응답받는 문제가 생긴다. 검색 결과에서 사용자와 더 가까운 비즈니스가 제외되지 않는 경우를 결과 집합이 유효하다고 정의한다. 하지만 이 경우엔 셀을 나누는 방식이 거칠기 때문에 결과가 유효하지 않게 되었다.</p>
<h2 id="Dynamic-Grids"><a href="#Dynamic-Grids" class="headerlink" title="Dynamic Grids"></a>Dynamic Grids</h2><p>셀의 크기가 10km나 되면 도시 지역에서는 사용하기 힘들지만, 도시 외곽이나 밀집도가 낮은 지역에서는 충분히 합당하다. 이상적으로는 인구 밀도가 낮은 지역에서는 크고 부정확한 셀을, 인구 밀도가 높은 지역에서는 더 작고 세분화된 셀을 사용할 수 있다.</p>
<p>쿼드트리는 2차원 공간을 적응 가능한 셀로 인코딩하는 데이터 구조다. 이진트리와 유사하게 쿼드트리는 잎이 아닌 모든 노드에 4개의 자식이 있는 트리구조다. 위치 맥락에서 이는 NW, NE, SW, SE의 사분면으로 나뉜다. 각 쿼드트리의 노드는 재귀적으로 세분화될 수 있고 단계를 거칠수록 셀이 더 작아진다.</p>
<p><img src="/image/system-design/2023-03-14-02.png" alt=""></p>
<p>쿼드트리는 사용하면 결과의 정확도와 유효성 사이에 균형을 맞출 수 있다. 개념적으로는 각 리프 노드가 충분히 정밀해 해당 노드에서 어떤 위치를 검색해도 동일한 비즈니스 집합을 찾을 수 있는 트리를 구축한다 가정하자. 이를 위해 전 세계를 대표하는 단일 노드에서 시작해 각 노드가 이 기준을 충족할 때 까지 필요에 따라 트리를 세분화 한다.</p>
<p><img src="/image/system-design/2023-03-14-03.png" alt=""></p>
<p>이 이미지의 각 사각형은 생성된 쿼드트리의 리프 노드를 나타내며 해당 범위 내의 모든 위치에는 동일한 인근 비즈니스 집합이 있다는 속성을 가진다.</p>
<p>매일 현재 진행중인 비즈니스를 기반으로 쿼드트리를 재계산하고, 일관된 검색 결과의 주요 기준을 충종하기 위한 간단한 휴리스틱을 사용한다. 노드 중심으로 한 검색 결과의 수가 임계값을 초과하는 경우, 노드를 세분화 한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public static void buildQuadtree(Node node) &#123;</span><br><span class="line">    if (searchBusinesses(node).size() &gt; 20) &#123;</span><br><span class="line">        node.subdivide();</span><br><span class="line">        for (Node child : node.getChildren()) &#123;</span><br><span class="line">            buildQuadtree(child);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>이 알고리즘은 고정된 검색 반경을 사용하는 대신 쿼드트리 노드의 크기에 비례하는 반경으로 검색한다. 이렇게 하면 캐시의 모든 항목에 비슷한 수의 검색 결과가 표시되도록 보장하는 동시에 검색 결과가 여전히 유효하는 것을 보장할 수 있다.</p>
<h2 id="Quadtrees-in-action"><a href="#Quadtrees-in-action" class="headerlink" title="Quadtrees in action"></a>Quadtrees in action</h2><p>서버에서 특정 위치 근처의 비즈니스에 대한 요청을 받으면 먼저 해당 위치의 쿼드트리 노드를 조회한 후 해당 노드를 캐시 키를 구축하는데 사용하고 필요한 경우 비즈니스 검색에 사용한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public static void getNearbyBusinesses(float latitude, float longitude) &#123;</span><br><span class="line">    QuadtreeNode node = lookupQuadtreeNode(latitude, longitude);</span><br><span class="line">    String cacheKey = &quot;quadtree_&quot; + node.getId();</span><br><span class="line">    List&lt;Result&gt; results = Cache.get(cacheKey);</span><br><span class="line">    if (results == null) &#123;</span><br><span class="line">        results = searchBusinesses(node);</span><br><span class="line">        Cache.set(cacheKey, results, &quot;2h&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    render(results);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>캐시 미스일때 수행되는 검색은 캐시 트리를 구축할 때 수행되는 검색과 동일하며, 노드 크기에 비례하는 반경으로 노드를 중심으로 검색이 수행된다.</p>
<h2 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h2><p>쿼드트리를 사용하면 높은 정밀도와 낮은 정밀도를 모두 갖춘 지리적 위치 캐싱의 장점을 결합할 수 있다. 위치를 기반으로 요청을 캐싱하는 것은 크고 지속적으로 변화하는 키 공간으로 인해 표준 캐싱의 어려움이 가중되는 까다로운 문제다. 쿼드트리는 지리적 분포에 따라 캐시된 결과의 세분성을 변경할 수 있도록 하여 문제를 단순화 한다.</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Song Hayoung</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://songhayoung.github.io/2023/03/13/System%20Design/etc/improved-location-caching-with-quadtrees/">https://songhayoung.github.io/2023/03/13/System%20Design/etc/improved-location-caching-with-quadtrees/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/System-Design/">System Design</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2023/03/14/PS/Codeforces/memsql-start-up-2-0-round-2-a/"><i class="fa fa-chevron-left">  </i><span>[Codeforces] MemSQL Start[c]UP 2.0 - Round 2 A. Golden System</span></a></div><div class="next-post pull-right"><a href="/2023/03/13/PS/CSAcademy/backpack-packing/"><span>[CS Academy] Backpack Packing</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="gitalk-container"></div><script>var gitalk = new Gitalk({
  clientID: '3604b61642355579f55e',
  clientSecret: 'f552120f18ac5aee3f6297e05e97d94c0a25cd4b',
  repo: 'SongHayoung.github.io',
  owner: 'SongHayoung',
  admin: 'SongHayoung',
  id: md5(decodeURI(location.pathname)),
  language: 'en'
})
gitalk.render('gitalk-container')</script></div></div><footer class="footer-bg" style="background-image: url(https://xxxx.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2020 - 2023 By Song Hayoung</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">Learning how to walk slowly to not miss important things</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.7.0"></script><script src="/js/fancybox.js?version=1.7.0"></script><script src="/js/sidebar.js?version=1.7.0"></script><script src="/js/copy.js?version=1.7.0"></script><script src="/js/fireworks.js?version=1.7.0"></script><script src="/js/transition.js?version=1.7.0"></script><script src="/js/scroll.js?version=1.7.0"></script><script src="/js/head.js?version=1.7.0"></script><script src="/js/search/algolia.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="algolia-search"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>